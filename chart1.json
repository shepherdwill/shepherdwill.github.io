{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",

  "description": "LINK FOR THE DATASET: https://www.ons.gov.uk/employmentandlabourmarket/peopleinwork/labourproductivity/timeseries/lzvb/prdy",

  "title": {
    "text": "Productivity, UK",
    "subtitle": ["Output per hour, whole economy", "Index, 2019=100; Source-series: ONS-LZVB", ""],
    "subtitleFontStyle":"italic",
    "subtitleFontSize":10,
    "anchor": "start",
    "color": "black"},

  "width":450,
  "height":300,

  "data": {
      "url": "https://raw.githubusercontent.com/shepherdwill/shepherdwill.github.io/refs/heads/main/dynamism_productivity/output_per_hour_worked_LDZB.csv",
      "format": {
        "type":"csv"}},

  "transform": [
    {"calculate": "timeParse(datum.Year, '%Y Q%q')", "as": "date"},
    {"calculate": "datum['Output per hour worked SA: Index 2022 = 100']", "as": "value"},
    {"filter": "year(datum.date) >= 1980"}
  ],

  "encoding": {"x": {"field": "date", "type": "temporal", "title":null}},

  "layer": [
      {"encoding": {
        "y": {
          "field": "value", 
          "type": "quantitative", 
          "title":null,
          "scale":{"domain":[40, 120]}}
        },
        
        "layer": [
          
          {"mark":{"type": "line","color": "red"}},
          
          {"transform": 
            [{"filter": {"selection": "hover"}}], 
               "mark": {
                 "type":"circle",
                 "size":150,
                 "color":"red"}}
      ]
    },
    
    {"mark": "rule", 
      "encoding": {
         "opacity": {
           "condition": {"value": 0.3, "selection": "hover"},
           "value": 0
             },
          
          "tooltip": [
          {"field": "date", "type": "temporal", "format": "%b-%Y", "title":"Date"},  
          {"field": "value", "type": "quantitative", "format": ",.0f", "title":"Index"}
            ]
           },

      "selection": {
        "hover": {
          "type": "single",
          "fields": ["date3"],
          "nearest": true,
          "on": "mouseover",
          "empty": "none",
          "clear": "mouseout"
        }
      }
    },
    
    {  "data": {
            "values": [
              {"y": "53", "x": "1980"},
              {"y": "116", "x": "2025"}
              ]
          },
          "mark": {
            "type": "line",
            "color":"blue", 
            "strokeDash": [1, 3]},
          "encoding": {
            "x": {"field": "x", "type": "temporal"},
            "y": {"field": "y", "type": "quantitative"}
          }
        }
  ]
}

